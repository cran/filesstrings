---
title: "Strings"
author: "Rory Nolan"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Strings}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, comment = "#>")
```

First let's load the library: 
```{r load}
library(filesstrings)
```

## The *n*^th^ number in a string
I often want to get the first, last or *n*^th^ number in a string.
```{r nth number}
pop <- "A population of 1000 comprised of 488 dogs and 512 cats."
NthNumber(pop, 1)
NthNumber(pop, -1)  # last number
```

## All the numbers in a string
```{r all the numbers}
ExtractNumbers(pop)
```

## All the non-numbers in a string
```{r all the non-numbers}
ExtractNonNumerics(pop)
```

## Split strings by numbers
```{r split by nums}
StrSplitByNums(pop)
```

## Could that be interpreted as numeric?
Sometimes we don't want to know is something *is* numeric, we want to know if it could be considered to be numeric (or could be coerced to numeric). For this, there's `CanBeNumeric()`.
```{r CanBeNumeric}
is.numeric(23)
is.numeric("23")
CanBeNumeric(23)
CanBeNumeric("23")
CanBeNumeric("23a")
```

## Get the *n*^th^ element of a string
```{r}
StrElem("abc", 2)
StrElem("abcdefz", -1)  # last element
```

## Trim anything (not just whitespace)
`stringr`'s `str_trim` just trims whitespace. What if you want to trim something else? Now you can `TrimAnything()`.
```{r trim anything}
TrimAnything("__rmarkdown_", "_")
```

## Count the number of matches of a pattern in a string
```{r count matches}
CountMatches(pop, " ")  # count the spaces in pop
CountMatches("Bob and Joe went to see Bob's mother.", "Bob")
```

## Turn duplicates of a pattern into singles
Suppose we want to remove double spacing:
```{r dups to sings}
double__spaced <- "Hello  world,  pretend  it's  Saturday  :-)"
CountMatches(double__spaced, " ")  # count the spaces
single_spaced <- DuplicatesToSingles(double__spaced, pattern = " ")
single_spaced
CountMatches(single_spaced, " ")  # half the spaces are gone
```

## The bit of a string after the *n*^th^ appearance of a pattern
Suppose we have sentences telling us about a couple of boxes:
```{r about a box}
box.infos <- c("Box 1 has weight 23kg and volume 0.3 cubic metres.",
               "Box 2 has weight 20kg and volume 0.33 cubic metres.")
```
We can get (for example) the weights of the boxes by taking the first number that appears after the word "weight".
```{r after weight}
library(magrittr)
StrAfterNth(box.infos, "weight", 1)  # the bit of the string after 1st "weight"
StrAfterNth(box.infos, "weight", 1) %>% NthNumber(1)  # 1st number after 1st "weight"
```
We'd like to put all of the box information into a nice data frame. Here's how.
```{r box df, message=FALSE}
tibble::tibble(box = NthNumber(box.infos, 1),
        weight = StrAfterNth(box.infos, "weight", 1) %>% 
          NthNumber(1, decimals = TRUE),
        volume = StrAfterNth(box.infos, "volume", 1) %>% 
          NthNumber(1, decimals = TRUE)
)
```

## Split camel case
Sometimes people use camel case (CamelCase) to avoid using spaces. What if we want to put the spaces back in?
```{r camel case}
camel.names <- c("JoeBloggs", "JaneyMac")
SplitCamelCase(camel.names)
```
Now we have a list where each list element is a vector of a person's names. To put them together with spaces in between, we can use `PasteCollapseListElems`. This is an efficient way to perform `paste(..., collapse = ...)` on each element of a list.
```{r PasteCollapseListElems}
SplitCamelCase(camel.names) %>% PasteCollapseListElems(" ")
```
